var crypto = require('crypto');

module.exports = Crypto = function(algorithm, secret) {
    this.algorithm = algorithm;
    this.secret = secret;
};
Crypto.prototype.cipher = function(plaintext) {
    var cipher = crypto.createCipher(this.algorithm, this.secret);
    return cipher.update(plaintext, 'utf8', 'base64') + cipher.final('base64');
};
Crypto.prototype.decipher = function(ciphered) {
    var decipher = crypto.createDecipher(this.algorithm, this.secret);
    return decipher.update(ciphered, 'base64', 'utf8') + decipher.final('utf8');
};