

exports = module.exports = function(){
    return function json(req, res, next) {
        if (req._rawBody) return next();
        req.rawBody = req.rawBody || '';
        if (!('transfer-encoding' in req.headers || 'content-length' in req.headers)) return next();
        req._rawBody = true;

        req.setEncoding('binary');
        req.on('data', function(chunk){
            req.rawBody += chunk;
        });
        req.on('end', function(){
            next();
        });
    };
};
