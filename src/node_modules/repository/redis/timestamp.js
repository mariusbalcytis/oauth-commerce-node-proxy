var _ = require('lodash')._;

var TimestampRepository = module.exports = function(redisClient) {
    this.redisClient = redisClient;
};

TimestampRepository.prototype.load = function(id, callback) {
    this.redisClient.hget('timestamps', id, function(err, reply) {
        if (err) {
            callback(err);
        } else {
            callback(null, reply ? parseInt(reply) : null);
        }
    });
};
TimestampRepository.prototype.save = function(id, timestampDiff, callback) {
    this.redisClient.hset('timestamps', id, JSON.stringify(timestampDiff), callback);
};